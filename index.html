<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Creating Advantages</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
        
        /* Define Cavaliers' color palette */
        :root {
            --cavs-wine: #6F263D;
            --cavs-gold: #FFC72C;
            --cavs-black: #000000;
            --cavs-white: #FFFFFF;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--cavs-white);
            color: var(--cavs-black);
        }
        .container {
            max-width: 1280px;
            margin: 0 auto;
            padding: 2rem;
        }
        .section-header {
            font-size: 2.25rem;
            font-weight: 700;
            color: var(--cavs-wine);
            margin-bottom: 1.5rem;
            text-align: center;
        }
        .card {
            background-color: #f8f8f8; /* A very light gray to differentiate from the background */
            border-radius: 1rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 2rem;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <div class="container">
        <header class="text-center py-12">
            <h1 class="text-5xl font-bold" style="color: var(--cavs-wine);">Creating Advantages</h1>
            <p class="mt-4 text-xl text-gray-600">Visualizing how NBA players create points by generating advantages.</p>
        </header>

        <section class="mb-16">
            <div class="card">
                <h2 class="section-header">How to Quantify It</h2>
                <p class="text-lg text-center mb-8">
                    "Advantage PTS Created" is a metric that quantifies how a player's actions lead to scoring opportunities for their team. It measures the points generated from various types of advantages created on the court.
                </p>

                <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-8 mt-8">
                    <div class="p-6 bg-gray-50 rounded-lg shadow-inner" style="background-color: var(--cavs-wine); color: var(--cavs-white);">
                        <h3 class="text-xl font-semibold mb-2" style="color: var(--cavs-gold);">Self-Creation</h3>
                        <p class="text-sm">Points a player scores through their own actions, such as one-on-one moves or off-the-dribble shots, without an immediate assist. Only includes self-creation that leads to high quality shots.</p>
                    </div>
                    <div class="p-6 bg-gray-50 rounded-lg shadow-inner" style="background-color: var(--cavs-wine); color: var(--cavs-white);">
                        <h3 class="text-xl font-semibold mb-2" style="color: var(--cavs-gold);">Create for Others</h3>
                        <p class="text-sm">Points generated from a player's passes that lead to a teammate's score, essentially quantifying their playmaking impact. Only includes potential assists that lead to high quality shots.</p>
                    </div>
                    <div class="p-6 bg-gray-50 rounded-lg shadow-inner" style="background-color: var(--cavs-wine); color: var(--cavs-white);">
                        <h3 class="text-xl font-semibold mb-2" style="color: var(--cavs-gold);">Basket Cuts</h3>
                        <p class="text-sm">Points created when a player makes a timely cut to the basket, catching the defense off-guard for a high-percentage score.</p>
                    </div>
                    <div class="p-6 bg-gray-50 rounded-lg shadow-inner" style="background-color: var(--cavs-wine); color: var(--cavs-white);">
                        <h3 class="text-xl font-semibold mb-2" style="color: var(--cavs-gold);">Movement Shooting</h3>
                        <p class="text-sm">Points from shots a player takes while moving, such as coming off screens or running in transition, leveraging their off-ball movement.</p>
                    </div>
                    <div class="p-6 bg-gray-50 rounded-lg shadow-inner" style="background-color: var(--cavs-wine); color: var(--cavs-white);">
                        <h3 class="text-xl font-semibold mb-2" style="color: var(--cavs-gold);">Offensive Rebounds</h3>
                        <p class="text-sm">Points created by a player after securing an offensive rebound.</p>
                    </div>
                    <div class="p-6 bg-gray-50 rounded-lg shadow-inner" style="background-color: var(--cavs-wine); color: var(--cavs-white);">
                        <h3 class="text-xl font-semibold mb-2" style="color: var(--cavs-gold);">Ball Control</h3>
                        <p class="text-sm">Points saved/lost by turnovers.</p>
                    </div>
                    <div class="p-6 bg-gray-50 rounded-lg shadow-inner" style="background-color: var(--cavs-wine); color: var(--cavs-white);">
                        <h3 class="text-xl font-semibold mb-2" style="color: var(--cavs-gold);">Drawing Doubles</h3>
                        <p class="text-sm">Points generated when a player's presence attracts a second defender, leaving a teammate open for a scoring play.</p>
                    </div>
                </div>
            </div>
        </section>

        <section class="mb-16">
            <div class="card">
                <h2 class="section-header">How Do Individual Players Create Advantages?</h2>
                <div class="flex flex-col md:flex-row justify-center items-center gap-4 mb-8">
                    <div>
                        <label for="team-select" class="text-lg font-medium mb-2">Select a Team:</label>
                        <select id="team-select" class="w-full md:w-48 p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2" style="border-color: var(--cavs-wine); focus-ring-color: var(--cavs-gold);">
                            <option value="">-- All Teams --</option>
                        </select>
                    </div>
                    <div>
                        <label for="player-select" class="text-lg font-medium mb-2">Select a Player:</label>
                        <select id="player-select" class="w-full md:w-48 p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2" style="border-color: var(--cavs-wine); focus-ring-color: var(--cavs-gold);">
                            <option value="">-- Choose a Player --</option>
                        </select>
                    </div>
                </div>
                <div class="h-96 md:h-[500px] w-full">
                    <canvas id="player-chart"></canvas>
                </div>
            </div>
        </section>

    </div>

    <script>
        let playerChart = null;
        let allPlayerData = []; // Store the full dataset
        const csvFilePath = 'Advantages Created.csv';

        // Function to parse the CSV data
        function parseCSV(csv) {
            const lines = csv.trim().split('\n');
            const headers = lines[0].split(',').map(h => h.trim());
            const data = lines.slice(1).map(line => {
                const values = line.split(',').map(v => v.trim());
                const player = {};
                headers.forEach((header, i) => {
                    if (header === 'Ballhandler' || header === 'Team') {
                        player[header] = values[i];
                    } else {
                        player[header] = parseFloat(values[i]);
                    }
                });
                return player;
            });
            return data;
        }

        // Function to populate the team dropdown
        function populateTeamDropdown(data) {
            const teamSelect = document.getElementById('team-select');
            const teams = [...new Set(data.map(player => player.Team))];
            teams.sort();

            teams.forEach(team => {
                const option = document.createElement('option');
                option.value = team;
                option.textContent = team;
                teamSelect.appendChild(option);
            });
        }

        // Function to populate the player dropdown based on team selection
        function populatePlayerDropdown(data, selectedTeam) {
            const playerSelect = document.getElementById('player-select');
            // Clear existing options except the first one
            while (playerSelect.options.length > 1) {
                playerSelect.remove(1);
            }

            const filteredPlayers = selectedTeam
                ? data.filter(player => player.Team === selectedTeam)
                : data;

            // Sort the filtered player data alphabetically by name
            filteredPlayers.sort((a, b) => {
                return a.Ballhandler.localeCompare(b.Ballhandler);
            });

            filteredPlayers.forEach(player => {
                const option = document.createElement('option');
                option.value = player.Ballhandler;
                option.textContent = player.Ballhandler;
                playerSelect.appendChild(option);
            });
        }

        // Function to update the chart with player data
        function updatePlayerChart(playerData) {
            const chartCanvas = document.getElementById('player-chart');
            const metricCategories = [
                'Self-Creation', 'Create for Others',
                'Basket Cuts', 'Movement Shooting', 'OREB',
                'Ball Control', 'Drawing Doubles'
            ];
            
            if (playerChart) {
                playerChart.destroy();
            }

            const metricData = playerData ? metricCategories.map(cat => playerData[cat]) : [];
            const titleText = playerData ? `${playerData.Ballhandler}'s Advantage Points Creation` : 'Please select a player';

            playerChart = new Chart(chartCanvas, {
                type: 'bar',
                data: {
                    labels: metricCategories,
                    datasets: [{
                        label: 'Advantage Points Created',
                        data: metricData,
                        backgroundColor: [
                            '#FFC72C', // True Gold
                            '#6F263D', // Wine
                            '#FFC72C', // True Gold
                            '#6F263D', // Wine
                            '#FFC72C', // True Gold
                            '#6F263D', // Wine
                            '#FFC72C'  // True Gold
                        ],
                        borderColor: '#000000', // Black
                        borderWidth: 1,
                        borderRadius: 6,
                        barPercentage: 0.8,
                        categoryPercentage: 0.9
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Points Created',
                                color: '#000000'
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.1)'
                            },
                            ticks: {
                                color: '#000000'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                color: '#000000'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false,
                        },
                        title: {
                            display: true,
                            text: titleText,
                            font: {
                                size: 18,
                                weight: 'bold'
                            },
                            color: '#000000'
                        },
                        tooltip: {
                            callbacks: {
                                title: (tooltipItems) => {
                                    const category = tooltipItems[0].label;
                                    const value = tooltipItems[0].raw;
                                    return `${category}: ${value} Pts`;
                                },
                                label: () => null,
                            }
                        }
                    }
                }
            });
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', () => {
            fetch(csvFilePath)
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    return response.text();
                })
                .then(csvData => {
                    allPlayerData = parseCSV(csvData);
                    populateTeamDropdown(allPlayerData);
                    populatePlayerDropdown(allPlayerData, null);
                    updatePlayerChart(null);
                })
                .catch(error => console.error('Error fetching the CSV file:', error));

            const teamSelect = document.getElementById('team-select');
            teamSelect.addEventListener('change', (event) => {
                const selectedTeam = event.target.value;
                populatePlayerDropdown(allPlayerData, selectedTeam);
                document.getElementById('player-select').value = ""; // Reset player dropdown
                updatePlayerChart(null); // Clear the chart
            });

            const playerSelect = document.getElementById('player-select');
            playerSelect.addEventListener('change', (event) => {
                const selectedPlayerName = event.target.value;
                const selectedPlayer = allPlayerData.find(p => p.Ballhandler === selectedPlayerName);
                updatePlayerChart(selectedPlayer);
            });
        });
    </script>
</body>
</html>
